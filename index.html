<!DOCTYPE html>
<html lang="ko">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>KSIKR - Enterprise ESG/LCA Platform (v102.0 Final Integration)</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css" rel="stylesheet">
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Pretendard:wght@300;400;500;600;700&display=swap');
        body { font-family: 'Pretendard', sans-serif; background-color: #f8fafc; }
        .nav-item { transition: all 0.2s; border-radius: 12px; font-weight: 600; color: #64748b; font-size: 14px; }
        .nav-item:hover { background-color: #f1f5f9; color: #334155; }
        .nav-active { background-color: #e0e7ff; color: #4338ca; box-shadow: 0 4px 6px -1px rgba(67, 56, 202, 0.1); }
        .kpi-card { background: white; border: 1px solid #e2e8f0; border-radius: 16px; padding: 20px; transition: transform 0.2s; }
        .kpi-card:hover { transform: translateY(-3px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }
        .input-field { width: 100%; border: 1px solid #cbd5e1; border-radius: 8px; padding: 8px 12px; font-size: 13px; text-align: right; transition: all 0.2s; }
        .input-field:focus { border-color: #6366f1; outline: none; ring: 2px solid #e0e7ff; }
        .input-readonly { background-color: #f1f5f9; color: #64748b; cursor: not-allowed; }
        .report-paper { width: 210mm; min-height: 297mm; padding: 20mm; margin: 0 auto; background: white; box-shadow: 0 0 20px rgba(0,0,0,0.05); border: 1px solid #e2e8f0; font-family: 'Times New Roman', serif; }
        .report-table { width: 100%; border-collapse: collapse; margin-bottom: 20px; font-size: 12px; }
        .report-table th, .report-table td { border: 1px solid #000; padding: 6px; text-align: left; }
        .report-table th { background-color: #f3f4f6; font-weight: bold; }
        .fade-in { animation: fadeIn 0.3s ease-in; }
        @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
        /* AI Modal Styles */
        .modal-overlay { background-color: rgba(15, 23, 42, 0.7); backdrop-filter: blur(4px); transition: all 0.3s; }
        .drop-zone { border: 2px dashed #cbd5e1; transition: all 0.2s; background-color: white; cursor: pointer; }
        .drop-zone.drag-over { border-color: #6366f1; background-color: #e0e7ff; transform: scale(1.02); }
    </style>
</head>
<body class="text-slate-800 h-screen flex flex-col overflow-hidden">

    <script>
        window.appState = {
            totalGWP: 0.00,
            breakdown: [0, 0, 0, 0, 0, 0], 
            // [DATA] History for Line Chart
            history: [
                { date: '2025-10-15', product: 'Basic Tee v1', gwp: 12.5 },
                { date: '2025-11-02', product: 'Summer Line', gwp: 15.2 },
                { date: '2025-11-20', product: 'Basic T-Shirt', gwp: 3.85 },
                { date: '2025-12-05', product: 'Denim Pants', gwp: 12.4 }
            ]
        };

        const PEF_CATS = { 'tshirt': { name: 'T-Shirts', life: 2.0, wash: 52, temp: 40 }, 'pants': { name: 'Pants', life: 3.0, wash: 30, temp: 30 } };
        const GRID_DB = { 'KR': { name: 'South Korea', factor: 0.478 }, 'CN': { name: 'China', factor: 0.584 }, 'VN': { name: 'Vietnam', factor: 0.450 } };
        const MATERIAL_DB = { 'cotton_conv': { name: 'Cotton (Conv)', ef: 1.8, waste: 0.05 }, 'poly_virgin': { name: 'Polyester', ef: 4.6, waste: 0.02 } };
        const PROCESS_DB = { 'spinning': { name: 'Spinning', energy: 3.5 }, 'dyeing': { name: 'Dyeing', energy: 8.0 } };
        const PACK_DB = { 'ldpe': { name: 'Polybag', ef: 2.5 }, 'box': { name: 'Box', ef: 0.8 } };
    </script>

    <div class="h-10 bg-slate-900 text-white flex items-center px-6 text-xs font-medium justify-between z-50 shadow-md shrink-0">
        <div class="flex items-center gap-4"><span class="bg-indigo-600 px-2 py-0.5 rounded text-[10px] font-bold tracking-wider">KSIKR OFFICIAL</span><span class="text-slate-400">v102.0 Final</span></div>
        <div class="flex items-center gap-4"><span class="flex items-center gap-2"><i class="fas fa-database text-slate-500"></i> DB: Ecoinvent 3.9</span></div>
    </div>

    <div class="flex flex-1 overflow-hidden h-full">
        <aside class="w-64 bg-white border-r border-slate-200 flex flex-col z-40">
            <div class="p-6 border-b border-slate-100 flex items-center gap-3">
                <div class="w-10 h-10 bg-indigo-700 rounded-xl flex items-center justify-center text-white font-black text-xl shadow-lg">K</div>
                <div><h1 class="text-lg font-extrabold text-slate-900">KSIKR <span class="text-indigo-600">LCA</span></h1></div>
            </div>
            <nav class="flex-1 p-4 space-y-2 overflow-y-auto">
                <button onclick="switchTab('dashboard')" id="btn-dashboard" class="nav-item w-full flex items-center gap-3 px-4 py-3 nav-active"><i class="fas fa-chart-line w-5 text-center"></i> ëŒ€ì‹œë³´ë“œ</button>
                <button onclick="switchTab('lca')" id="btn-lca" class="nav-item w-full flex items-center gap-3 px-4 py-3"><i class="fas fa-calculator w-5 text-center"></i> ì •ë°€ LCA ì‚°ì •</button>
                <button onclick="switchTab('report')" id="btn-report" class="nav-item w-full flex items-center gap-3 px-4 py-3"><i class="fas fa-file-contract w-5 text-center"></i> ì¸ì¦ ë¦¬í¬íŠ¸</button>
                <button onclick="switchTab('corporate')" id="btn-corporate" class="nav-item w-full flex items-center gap-3 px-4 py-3"><i class="fas fa-building w-5 text-center"></i> ê¸°ì—… ì •ë³´</button>
            </nav>
        </aside>

        <main class="flex-1 overflow-y-auto relative scroll-smooth bg-slate-50 p-8">
            <section id="tab-dashboard" class="fade-in max-w-7xl mx-auto">
                <header class="flex justify-between items-end mb-8">
                    <div><h2 class="text-3xl font-bold text-slate-800">í†µí•© ê´€ì œ ëŒ€ì‹œë³´ë“œ</h2></div>
                    <button onclick="switchTab('lca')" class="px-5 py-2.5 bg-indigo-600 text-white rounded-xl text-sm font-bold shadow-lg hover:bg-indigo-700">ì‹ ê·œ í‰ê°€ ì‹œì‘</button>
                </header>
                <div class="grid grid-cols-4 gap-5 mb-8">
                    <div class="kpi-card"><div class="flex justify-between mb-2"><span class="text-xs font-bold text-slate-500">AVG GWP</span><i class="fas fa-cloud text-indigo-200"></i></div><h3 class="text-2xl font-bold text-slate-800"><span id="dash-avg-gwp">--</span> <span class="text-sm text-slate-400">kg</span></h3></div>
                    <div class="kpi-card"><div class="flex justify-between mb-2"><span class="text-xs font-bold text-slate-500">COMPLIANCE</span><i class="fas fa-shield-alt text-green-200"></i></div><h3 class="text-xl font-bold text-green-700">ESPR Ready</h3></div>
                    <div class="kpi-card"><div class="flex justify-between mb-2"><span class="text-xs font-bold text-slate-500">CBAM RISK</span><i class="fas fa-exclamation-triangle text-yellow-200"></i></div><h3 class="text-2xl font-bold text-slate-800">Low</h3></div>
                    <div class="kpi-card"><div class="flex justify-between mb-2"><span class="text-xs font-bold text-slate-500">COST SAVING</span><i class="fas fa-won-sign text-blue-200"></i></div><h3 class="text-2xl font-bold text-slate-800">â‚© 12.5M</h3></div>
                </div>
                <div class="grid grid-cols-3 gap-6">
                    <div class="col-span-2 bg-white p-6 rounded-2xl border shadow-sm"><h4 class="font-bold text-slate-800 mb-4">ë°°ì¶œëŸ‰ ì¶”ì´ (History)</h4><div class="h-64"><canvas id="lineChart"></canvas></div></div>
                    <div class="col-span-1 bg-white p-6 rounded-2xl border shadow-sm"><h4 class="font-bold text-slate-800 mb-4">í‰ê°€ í•«ìŠ¤íŒŸ (Hotspot)</h4><div class="h-64"><canvas id="donutChart"></canvas></div></div>
                </div>
            </section>

            <section id="tab-lca" class="hidden fade-in max-w-7xl mx-auto">
                <div class="flex justify-between items-center mb-6">
                    <h2 class="text-2xl font-bold text-slate-800">ì •ë°€ ì „ê³¼ì •í‰ê°€ (LCA)</h2>
                    <button onclick="openAI()" class="px-4 py-2 bg-gradient-to-r from-indigo-600 to-violet-600 text-white rounded-lg text-sm font-bold shadow hover:shadow-lg flex items-center gap-2">
                        <i class="fas fa-robot"></i> AI ìŠ¤ë§ˆíŠ¸ ë°ì´í„° ê°€ì ¸ì˜¤ê¸°
                    </button>
                </div>

                <div class="grid grid-cols-12 gap-8">
                    <div class="col-span-8 space-y-6 pb-20">
                        <div class="bg-white p-6 rounded-xl border shadow-sm">
                            <h5 class="font-bold text-slate-800 mb-4 border-l-4 border-indigo-600 pl-3">1. ì œí’ˆ ì •ì˜</h5>
                            <div class="grid grid-cols-2 gap-4">
                                <div><label class="text-xs font-bold text-slate-500 block mb-1">ì¹´í…Œê³ ë¦¬</label><select id="lca-cat" class="input-field bg-slate-50" onchange="setDefaults()"></select></div>
                                <div><label class="text-xs font-bold text-slate-500 block mb-1">ìƒì‚° êµ­ê°€</label><select id="lca-grid" class="input-field" onchange="calc()"></select></div>
                            </div>
                        </div>
                        <div class="bg-white rounded-xl border shadow-sm">
                            <div class="bg-slate-50 px-6 py-4 border-b flex justify-between items-center">
                                <h5 class="font-bold text-slate-800 border-l-4 border-indigo-600 pl-3">2. ìì¬ëª…ì„¸ì„œ (BOM)</h5>
                                <button onclick="addBomRow()" class="text-xs bg-white border border-indigo-200 text-indigo-700 px-3 py-1.5 rounded font-bold hover:bg-indigo-50 shadow-sm">+ ìì¬ ì¶”ê°€</button>
                            </div>
                            <table class="w-full text-sm text-left"><tbody id="bom-body"></tbody></table>
                        </div>
                        <div class="bg-white p-6 rounded-xl border shadow-sm ring-1 ring-indigo-100">
                            <h5 class="font-bold text-slate-800 border-l-4 border-indigo-600 pl-3 mb-4">3. ì œì¡° ì—ë„ˆì§€ (Energy)</h5>
                            <div class="grid grid-cols-3 gap-4">
                                <div><label class="text-xs font-bold text-slate-500 block mb-1">ì „ë ¥ (kWh)</label><input type="number" id="inp-elec" class="input-field" value="0" min="0" oninput="calc()"></div>
                                <div><label class="text-xs font-bold text-slate-500 block mb-1">ê°€ìŠ¤ (MJ)</label><input type="number" id="inp-gas" class="input-field" value="0" min="0" oninput="calc()"></div>
                                <div><label class="text-xs font-bold text-slate-500 block mb-1">ìš©ìˆ˜ (ton)</label><input type="number" id="inp-water" class="input-field" value="0" min="0" oninput="calc()"></div>
                            </div>
                        </div>
                        <div class="bg-white p-6 rounded-xl border shadow-sm">
                            <h5 class="font-bold text-slate-800 mb-4 border-l-4 border-indigo-600 pl-3">4. í¬ì¥/ë¬¼ë¥˜/ì‚¬ìš©/íê¸°</h5>
                            <div class="grid grid-cols-2 gap-4 mb-4">
                                <div><label class="text-xs font-bold text-slate-500 block mb-1">í¬ì¥ì¬</label><select id="lca-pack" class="input-field" onchange="calc()"></select></div>
                                <div><label class="text-xs font-bold text-slate-500 block mb-1">í¬ì¥ ì¤‘ëŸ‰ (kg)</label><input type="number" id="lca-pweight" class="input-field" value="0.05" oninput="calc()"></div>
                            </div>
                            <div class="grid grid-cols-3 gap-4">
                                <div><label class="text-xs font-bold text-slate-500 block mb-1">ìš´ì†¡ê±°ë¦¬ (km)</label><input type="number" id="lca-dist" class="input-field" value="10000" oninput="calc()"></div>
                                <div><label class="text-xs font-bold text-indigo-600 block mb-1">ì„¸íƒì˜¨ë„ (â„ƒ)</label><input type="number" id="lca-temp" class="input-field font-bold text-indigo-700 bg-indigo-50" oninput="calc()"></div>
                                <div><label class="text-xs font-bold text-slate-500 block mb-1">íê¸°</label><select id="lca-eol-mode" class="input-field" onchange="calc()"><option value="landfill">ë§¤ë¦½</option><option value="incineration">ì†Œê°</option><option value="recycle">ì¬í™œìš©</option></select></div>
                            </div>
                            <input type="hidden" id="lca-life"><input type="hidden" id="lca-wash"><input type="hidden" id="lca-mode" value="ship"><input type="hidden" id="lca-retail" value="30">
                        </div>
                    </div>
                    <div class="col-span-4">
                        <div class="bg-slate-900 text-white rounded-xl p-6 shadow-xl sticky top-6">
                            <h5 class="text-xs font-bold text-slate-400 mb-4 tracking-widest">REAL-TIME GWP</h5>
                            <div class="text-4xl font-black mb-6"><span id="live-total">0.00</span> <span class="text-base font-normal text-slate-400">kgCO2e</span></div>
                            <div class="space-y-3 text-sm border-t border-slate-700 pt-4">
                                <div class="flex justify-between text-slate-300"><span>ğŸ§± Mat</span><span id="res-mat">0.00</span></div>
                                <div class="flex justify-between text-yellow-400 font-bold"><span>ğŸ­ Eng</span><span id="res-eng">0.00</span></div>
                                <div class="flex justify-between text-slate-300"><span>ğŸ“¦ Log</span><span id="res-log">0.00</span></div>
                                <div class="flex justify-between text-slate-300"><span>ğŸ‘• Use</span><span id="res-use">0.00</span></div>
                                <div class="flex justify-between text-slate-300"><span>â™»ï¸ EOL</span><span id="res-eol">0.00</span></div>
                            </div>
                            <button onclick="saveCalc()" class="w-full bg-indigo-600 hover:bg-indigo-500 mt-8 py-3 rounded-lg font-bold shadow-lg transition">ê²°ê³¼ ì €ì¥</button>
                        </div>
                    </div>
                </div>
            </section>

            <section id="tab-report" class="hidden fade-in max-w-5xl mx-auto">
                <header class="flex justify-between items-end mb-6"><h2 class="text-2xl font-bold text-slate-800">ì¸ì¦ ë¦¬í¬íŠ¸</h2><button onclick="window.print()" class="bg-white border px-4 py-2 rounded shadow">ì¸ì‡„</button></header>
                <div class="report-paper"><h1 class="text-3xl font-bold font-serif mb-8 border-b pb-4">LCA REPORT</h1><div id="rep-content" class="text-sm"></div></div>
            </section>
            
            <section id="tab-corporate" class="hidden fade-in max-w-5xl mx-auto">
                <h2 class="text-2xl font-bold text-slate-800 mb-6">ê¸°ì—… ì •ë³´</h2>
                <div class="bg-white p-8 rounded-xl border shadow-sm">
                    <div class="flex gap-2 mb-4"><input type="text" id="biz-no" class="input-field w-64" placeholder="ì‚¬ì—…ìë²ˆí˜¸"><button onclick="fetchCorporateInfo()" class="bg-slate-800 text-white px-4 rounded">ì¡°íšŒ</button></div>
                    <div class="grid grid-cols-2 gap-4"><input id="corp-name" class="input-field" readonly placeholder="ë²•ì¸ëª…"><input id="corp-rep" class="input-field" readonly placeholder="ëŒ€í‘œì"></div>
                </div>
            </section>
        </main>
    </div>

    <div id="aiModal" class="hidden fixed inset-0 z-50 flex items-center justify-center modal-overlay bg-slate-900/80 backdrop-blur-sm">
        <div class="bg-white w-full max-w-4xl h-[80vh] rounded-2xl shadow-2xl flex flex-col overflow-hidden">
            <div class="bg-slate-900 text-white px-6 py-4 flex justify-between items-center"><h3 class="font-bold">AI Smart Data Collector</h3><button onclick="closeAI()" class="text-white"><i class="fas fa-times"></i></button></div>
            <div class="flex-1 p-8 bg-slate-50 grid grid-cols-2 gap-8">
                <div id="drop-zone" class="bg-white border-2 border-dashed border-indigo-200 rounded-xl flex flex-col items-center justify-center p-8 text-center drop-zone">
                    <i class="fas fa-cloud-upload-alt text-4xl text-indigo-400 mb-4"></i>
                    <h4 class="font-bold text-slate-700">íŒŒì¼ì„ ì—¬ê¸°ì— ë“œë˜ê·¸í•˜ì„¸ìš”</h4>
                    <p class="text-xs text-slate-400">Drag & Drop Here</p>
                </div>
                <div class="bg-slate-900 rounded-xl p-4 text-xs font-mono text-green-400 overflow-y-auto" id="ai-preview">Waiting for file...</div>
            </div>
            <div class="p-6 bg-white border-t flex justify-end gap-3">
                <button onclick="closeAI()" class="px-4 py-2 text-slate-500 font-bold">ì·¨ì†Œ</button>
                <button onclick="applyAI()" class="px-6 py-2 bg-indigo-600 text-white rounded-lg font-bold shadow">ë°ì´í„° ì ìš©</button>
            </div>
        </div>
    </div>

    <script>
        // Init
        const catSel = document.getElementById('lca-cat');
        Object.keys(PEF_CATS).forEach(k => catSel.innerHTML += `<option value="${k}">${PEF_CATS[k].name}</option>`);
        const gridSel = document.getElementById('lca-grid');
        Object.keys(GRID_DB).forEach(k => gridSel.innerHTML += `<option value="${k}">${GRID_DB[k].name}</option>`);
        const packSel = document.getElementById('lca-pack');
        Object.keys(PACK_DB).forEach(k => packSel.innerHTML += `<option value="${k}">${PACK_DB[k].name}</option>`);
        
        // Drag & Drop
        const dropZone = document.getElementById('drop-zone');
        ['dragenter', 'dragover', 'dragleave', 'drop'].forEach(e => dropZone.addEventListener(e, ev => { ev.preventDefault(); ev.stopPropagation(); }, false));
        ['dragenter', 'dragover'].forEach(e => dropZone.addEventListener(e, () => dropZone.classList.add('drag-over'), false));
        ['dragleave', 'drop'].forEach(e => dropZone.addEventListener(e, () => dropZone.classList.remove('drag-over'), false));
        dropZone.addEventListener('drop', (e) => { if(e.dataTransfer.files.length) runAIAnalysis(e.dataTransfer.files[0].name); }, false);

        // Functions
        function switchTab(id) {
            document.querySelectorAll('section').forEach(s => s.classList.add('hidden'));
            document.getElementById('tab-'+id).classList.remove('hidden');
            if(id==='report') updateReport();
            if(id==='dashboard') updateCharts();
        }

        function openAI() { document.getElementById('aiModal').classList.remove('hidden'); }
        function closeAI() { document.getElementById('aiModal').classList.add('hidden'); }

        function runAIAnalysis(filename) {
            const preview = document.getElementById('ai-preview');
            preview.innerHTML = `> Analyzing ${filename}...<br>> Reading BOM...<br>> Mapping Energy...<br><br>`;
            setTimeout(() => {
                preview.innerHTML += "<span class='text-white font-bold'>[SUCCESS]</span><br>+ Cotton: 0.25kg<br>+ Elec: 1.5kWh<br>+ Gas: 0.5MJ<br><br>> Ready to Apply.";
            }, 800);
        }

        function applyAI() {
            document.getElementById('inp-elec').value = 1.5;
            document.getElementById('inp-gas').value = 0.5;
            
            const tbody = document.getElementById('bom-body');
            tbody.innerHTML = '';
            
            const tr = document.createElement('tr');
            tr.className = "border-b";
            tr.innerHTML = `<td class="p-2"><select class="w-full border p-1 mat-select" onchange="calc()"><option value="cotton_conv">Cotton (Conv)</option></select></td><td class="p-2"><select class="w-full border p-1 proc-select"><option value="spinning">Spinning</option></select></td><td class="p-2 text-right"><input type="number" class="w-20 border p-1 text-right weight-input" value="0.25" oninput="calc()"></td><td class="text-center"><button onclick="this.closest('tr').remove();calc()" class="text-slate-400 hover:text-red-500"><i class="fas fa-trash"></i></button></td>`;
            tbody.appendChild(tr);
            
            calc();
            closeAI();
            setTimeout(() => alert('AI ë°ì´í„°ê°€ ì„±ê³µì ìœ¼ë¡œ ë§¤í•‘ë˜ì—ˆìŠµë‹ˆë‹¤.'), 100);
        }

        function addBomRow() {
            const tbody = document.getElementById('bom-body');
            const tr = document.createElement('tr');
            tr.className = "border-b";
            tr.innerHTML = `<td class="p-2"><select class="w-full border p-1 mat-select" onchange="calc()">${Object.keys(MATERIAL_DB).map(k=>`<option value="${k}">${MATERIAL_DB[k].name}</option>`).join('')}</select></td><td class="p-2"><select class="w-full border p-1 proc-select">${Object.keys(PROCESS_DB).map(k=>`<option value="${k}">${PROCESS_DB[k].name}</option>`).join('')}</select></td><td class="p-2 text-right"><input type="number" class="w-20 border p-1 text-right weight-input" value="0.2" oninput="calc()"></td><td class="text-center"><button onclick="this.closest('tr').remove();calc()"><i class="fas fa-trash"></i></button></td>`;
            tbody.appendChild(tr);
            calc();
        }

        function setDefaults() {
            const d = PEF_CATS[document.getElementById('lca-cat').value];
            document.getElementById('lca-life').value = d.life;
            document.getElementById('lca-wash').value = d.wash;
            document.getElementById('lca-temp').value = d.temp;
            calc();
        }

        function calc() {
            let sumMat = 0;
            document.querySelectorAll('#bom-body tr').forEach(r => {
                const w = parseFloat(r.querySelector('.weight-input').value)||0;
                sumMat += w * 1.8;
            });
            const elec = parseFloat(document.getElementById('inp-elec').value)||0;
            const gas = parseFloat(document.getElementById('inp-gas').value)||0;
            const eng = (elec * 0.478) + (gas * 0.2);
            const total = sumMat + eng + 0.5;
            
            document.getElementById('live-total').innerText = total.toFixed(2);
            document.getElementById('res-mat').innerText = sumMat.toFixed(2);
            document.getElementById('res-eng').innerText = eng.toFixed(2);
            
            window.appState.totalGWP = total;
            window.appState.breakdown = [sumMat, eng, 0.2, 5.0, 0.1]; // Mock breakdown for responsiveness
            
            // Real-time chart update if visible
            if(window.donutChart) {
                window.donutChart.data.datasets[0].data = window.appState.breakdown;
                window.donutChart.update();
            }
        }

        function saveCalc() {
            const val = document.getElementById('live-total').innerText;
            const today = new Date().toISOString().split('T')[0];
            window.appState.history.unshift({ date: today, product: 'New Product', gwp: val });
            
            // Calc avg
            const total = window.appState.history.reduce((acc, curr) => acc + parseFloat(curr.gwp), 0);
            const avg = (total / window.appState.history.length).toFixed(2);
            document.getElementById('dash-avg-gwp').innerText = avg;

            alert('ì €ì¥ë˜ì—ˆìŠµë‹ˆë‹¤.');
            switchTab('dashboard');
        }

        function updateReport() {
            document.getElementById('rep-content').innerHTML = `
                <table class="w-full border collapse">
                    <tr><th class="border p-2 bg-gray-100">Total GWP</th><td class="border p-2 font-bold text-lg">${document.getElementById('live-total').innerText} kgCO2e</td></tr>
                    <tr><th class="border p-2 bg-gray-100">Materials</th><td class="border p-2">${document.getElementById('res-mat').innerText}</td></tr>
                    <tr><th class="border p-2 bg-gray-100">Energy</th><td class="border p-2">${document.getElementById('res-eng').innerText}</td></tr>
                </table>`;
        }

        function fetchCorporateInfo() {
            setTimeout(() => {
                document.getElementById('corp-name').value = '(ì£¼)í•œêµ­ì§€ì†ê°€ëŠ¥ì„±ì—°êµ¬ì›';
                document.getElementById('corp-rep').value = 'ê¹€ì£¼í˜„';
            }, 500);
        }

        // Charts Init
        const lineCtx = document.getElementById('lineChart');
        const donutCtx = document.getElementById('donutChart');
        
        window.lineChart = new Chart(lineCtx, { type: 'line', data: { labels: [], datasets: [{ label: 'GWP Trend', data: [], borderColor: '#4f46e5', tension: 0.4 }] } });
        window.donutChart = new Chart(donutCtx, { type: 'doughnut', data: { labels: ['Mat','Eng','Log','Use','EOL'], datasets: [{ data: [1,1,1,1,1], backgroundColor: ['#4f46e5','#f59e0b','#10b981','#3b82f6','#64748b'] }] }, options: { cutout:'70%' } });

        function updateCharts() {
            // Update Line Chart (History)
            const sortedHistory = [...window.appState.history].sort((a, b) => new Date(a.date) - new Date(b.date));
            window.lineChart.data.labels = sortedHistory.map(h => h.date);
            window.lineChart.data.datasets[0].data = sortedHistory.map(h => h.gwp);
            window.lineChart.update();

            // Update Donut Chart (Current Breakdown)
            window.donutChart.data.datasets[0].data = window.appState.breakdown;
            window.donutChart.update();
        }

        // Init Calls
        addBomRow();
        setDefaults();
        // Initial chart render
        updateCharts(); 
    </script>
</body>
</html>
